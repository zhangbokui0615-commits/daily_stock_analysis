name: Aè‚¡å…¨çƒåŒæ ¸åˆ†æ

on:
  schedule:
    # â° UTC 01:00 = åŒ—äº¬æ—¶é—´ 09:00ï¼ˆå‘¨ä¸€è‡³å‘¨äº”ï¼‰
    - cron: '0 1 * * 1-5'
  workflow_dispatch:   # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  build:
    runs-on: ubuntu-latest

    env:
      TZ: Asia/Shanghai   # æ˜ç¡®æ—¶åŒºï¼Œè®©æ—¥å¿—æ˜¾ç¤ºåŒ—äº¬æ—¶é—´

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'  # ä¿æŒ 3.11 ä»¥å…¼å®¹æœ€æ–°ç‰ˆ yfinance

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          # ğŸ’¡ è¡¥å…¨äº†è„šæœ¬è¿è¡Œå¿…é¡»çš„ pandas å’Œ pytz
          pip install yfinance requests pandas pytz

      - name: Run Global Market Analysis
        env: 
          # ğŸ”‘ ç¡®ä¿ GitHub Secrets ä¸­å·²é…ç½®è¿™ä¸¤ä¸ªå˜é‡
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          PUSHPLUS_TOKEN: ${{ secrets.PUSHPLUS_TOKEN }}
        run: python global_report.py  # âš ï¸ è¯·ç¡®ä¿æ‚¨çš„ Python æ–‡ä»¶åç¡®å®æ˜¯è¿™ä¸ª
