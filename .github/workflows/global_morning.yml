name: Aè‚¡å…¨çƒåŒæ ¸åˆ†ææ¨é€

on:
  schedule:
    # â° åŒ—äº¬æ—¶é—´æ¯å¤©æ—©ä¸Š 09:00 è¿è¡Œ (å¯¹åº” UTC 01:00)
    - cron: '0 1 * * 1-5'
  workflow_dispatch:   # å…è®¸æ‚¨åœ¨ GitHub ç½‘é¡µä¸Šæ‰‹åŠ¨ç‚¹å‡»è¿è¡Œè¿›è¡Œæµ‹è¯•

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4

      - name: è®¾ç½® Python ç¯å¢ƒ
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: å®‰è£…ä¾èµ–åº“ (ä¿®å¤ ModuleNotFoundError)
        run: |
          python -m pip install --upgrade pip
          # ğŸ’¡ è¿™é‡Œä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰è¿è¡Œ global_report.py å¿…é¡»çš„æ’ä»¶
          pip install akshare yfinance pandas requests pytz

      - name: è¿è¡Œå…¨çƒåŒæ ¸åˆ†æè„šæœ¬
        env: 
          # ğŸ”‘ è¯·ç¡®ä¿åœ¨ä»“åº“ Settings -> Secrets ä¸­å·²é…ç½®ä»¥ä¸‹ä¸¤ä¸ªå˜é‡
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          PUSHPLUS_TOKEN: ${{ secrets.PUSHPLUS_TOKEN }}
        run: python global_report.py
